{
  "version": "1.0.0",
  "description": "Secret detection patterns for auto-redaction in session capture. Each pattern includes a regex, confidence level, and category for reporting.",
  "patterns": [
    {
      "name": "OpenAI API Key",
      "regex": "sk-[A-Za-z0-9]{20,}T3BlbkFJ[A-Za-z0-9]{20,}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "OpenAI Project API Key",
      "regex": "sk-proj-[A-Za-z0-9_-]{40,}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "Anthropic API Key",
      "regex": "sk-ant-[A-Za-z0-9_-]{40,}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "GitHub Personal Access Token (Classic)",
      "regex": "ghp_[A-Za-z0-9]{36,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "GitHub OAuth Access Token",
      "regex": "gho_[A-Za-z0-9]{36,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "GitHub Fine-Grained Token",
      "regex": "github_pat_[A-Za-z0-9_]{22,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "GitHub App Token",
      "regex": "(?:ghs|ghu|ghr)_[A-Za-z0-9]{36,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "AWS Access Key ID",
      "regex": "AKIA[0-9A-Z]{16}",
      "confidence": "high",
      "category": "credential"
    },
    {
      "name": "AWS Secret Access Key",
      "regex": "(?:aws_secret_access_key|AWS_SECRET_ACCESS_KEY)\\s*[=:]\\s*[A-Za-z0-9/+=]{40}",
      "confidence": "high",
      "category": "credential"
    },
    {
      "name": "AWS Session Token",
      "regex": "(?:aws_session_token|AWS_SESSION_TOKEN)\\s*[=:]\\s*[A-Za-z0-9/+=]{100,}",
      "confidence": "high",
      "category": "credential"
    },
    {
      "name": "Google API Key",
      "regex": "AIza[0-9A-Za-z_-]{35}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "Google OAuth Client Secret",
      "regex": "GOCSPX-[A-Za-z0-9_-]{28,}",
      "confidence": "high",
      "category": "credential"
    },
    {
      "name": "Slack Bot Token",
      "regex": "xoxb-[0-9]{10,}-[0-9]{10,}-[A-Za-z0-9]{24,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "Slack User Token",
      "regex": "xoxp-[0-9]{10,}-[0-9]{10,}-[0-9]{10,}-[a-f0-9]{32}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "Slack Webhook URL",
      "regex": "https://hooks\\.slack\\.com/services/T[A-Z0-9]{8,}/B[A-Z0-9]{8,}/[A-Za-z0-9]{24,}",
      "confidence": "high",
      "category": "webhook"
    },
    {
      "name": "Stripe Secret Key",
      "regex": "sk_(?:live|test)_[A-Za-z0-9]{24,}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "Stripe Publishable Key",
      "regex": "pk_(?:live|test)_[A-Za-z0-9]{24,}",
      "confidence": "medium",
      "category": "api_key"
    },
    {
      "name": "Twilio API Key",
      "regex": "SK[0-9a-fA-F]{32}",
      "confidence": "medium",
      "category": "api_key"
    },
    {
      "name": "SendGrid API Key",
      "regex": "SG\\.[A-Za-z0-9_-]{22,}\\.[A-Za-z0-9_-]{22,}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "Supabase Service Role Key",
      "regex": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\\.[A-Za-z0-9_-]{50,}\\.[A-Za-z0-9_-]{20,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "Generic JWT Token",
      "regex": "eyJ[A-Za-z0-9_-]{10,}\\.eyJ[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9_-]{10,}",
      "confidence": "medium",
      "category": "token"
    },
    {
      "name": "SSH Private Key",
      "regex": "-----BEGIN (?:RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----",
      "confidence": "high",
      "category": "private_key"
    },
    {
      "name": "PGP Private Key",
      "regex": "-----BEGIN PGP PRIVATE KEY BLOCK-----",
      "confidence": "high",
      "category": "private_key"
    },
    {
      "name": "Database Connection String (PostgreSQL)",
      "regex": "postgres(?:ql)?://[^:]+:[^@]+@[^/]+/[^\\s\"']+",
      "confidence": "high",
      "category": "connection_string"
    },
    {
      "name": "Database Connection String (MySQL)",
      "regex": "mysql://[^:]+:[^@]+@[^/]+/[^\\s\"']+",
      "confidence": "high",
      "category": "connection_string"
    },
    {
      "name": "Database Connection String (MongoDB)",
      "regex": "mongodb(?:\\+srv)?://[^:]+:[^@]+@[^/]+",
      "confidence": "high",
      "category": "connection_string"
    },
    {
      "name": "Redis Connection String",
      "regex": "redis://[^:]*:[^@]+@[^/]+",
      "confidence": "high",
      "category": "connection_string"
    },
    {
      "name": "Heroku API Key",
      "regex": "heroku_[A-Za-z0-9]{8}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{12}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "Mailgun API Key",
      "regex": "key-[A-Za-z0-9]{32}",
      "confidence": "medium",
      "category": "api_key"
    },
    {
      "name": "npm Token",
      "regex": "npm_[A-Za-z0-9]{36}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "PyPI Token",
      "regex": "pypi-[A-Za-z0-9_-]{50,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "Generic Password in URL",
      "regex": "://[^:]+:([^@]{8,})@",
      "confidence": "medium",
      "category": "credential"
    },
    {
      "name": "Generic Secret Assignment",
      "regex": "(?:secret|password|passwd|api_key|apikey|access_token|auth_token|private_key)\\s*[=:]\\s*[\"'][^\"']{8,}[\"']",
      "confidence": "medium",
      "category": "credential"
    },
    {
      "name": "Bearer Token",
      "regex": "Bearer\\s+[A-Za-z0-9_-]{20,}",
      "confidence": "medium",
      "category": "token"
    },
    {
      "name": "Base64 Encoded Credentials",
      "regex": "Basic\\s+[A-Za-z0-9+/]{20,}={0,2}",
      "confidence": "medium",
      "category": "credential"
    },
    {
      "name": "Discord Bot Token",
      "regex": "[MN][A-Za-z0-9]{23,}\\.[A-Za-z0-9_-]{6}\\.[A-Za-z0-9_-]{27,}",
      "confidence": "high",
      "category": "token"
    },
    {
      "name": "Datadog API Key",
      "regex": "(?:dd|datadog)(?:_api_key|_app_key)\\s*[=:]\\s*[a-f0-9]{32,}",
      "confidence": "high",
      "category": "api_key"
    },
    {
      "name": "Azure Storage Account Key",
      "regex": "DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/=]{44,};",
      "confidence": "high",
      "category": "credential"
    }
  ],
  "whitelist": [
    {
      "name": "UUID v4",
      "regex": "[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}",
      "description": "Standard UUID v4 format - not a secret"
    },
    {
      "name": "Generic UUID",
      "regex": "[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
      "description": "Generic UUID format - not a secret"
    },
    {
      "name": "Placeholder Token",
      "regex": "(?:sk-|ghp_|xoxb-)(?:your|test|example|fake|dummy|placeholder|xxx|XXXXX|sample)[A-Za-z0-9_-]*",
      "description": "Known placeholder/example tokens"
    },
    {
      "name": "Git Commit Hash",
      "regex": "\\b[0-9a-f]{40}\\b",
      "description": "40-char hex strings are likely git commit hashes"
    },
    {
      "name": "SHA-256 Hash",
      "regex": "\\b[0-9a-f]{64}\\b",
      "description": "64-char hex strings are likely SHA-256 hashes"
    },
    {
      "name": "File Path Hash Component",
      "regex": "/[0-9a-f]{32,}/",
      "description": "Hex strings embedded in file paths are likely directory hashes"
    },
    {
      "name": "Hex Color Code",
      "regex": "#[0-9a-fA-F]{6}\\b",
      "description": "CSS hex color codes"
    },
    {
      "name": "Supabase Anon Key (Public)",
      "regex": "sb_publishable_[A-Za-z0-9_-]+",
      "description": "Supabase publishable/anon keys are intentionally public"
    },
    {
      "name": "Documentation Example",
      "regex": "^(?:EXAMPLE|REPLACE_ME|INSERT_YOUR|YOUR_)[A-Z_]+(?:_HERE|_KEY|_TOKEN)?$",
      "description": "Standalone documentation placeholder strings (full match only)"
    }
  ],
  "entropy": {
    "enabled": true,
    "min_length": 16,
    "threshold": 4.5,
    "description": "Strings with Shannon entropy above threshold and minimum length are flagged as potential secrets (medium confidence)"
  }
}
